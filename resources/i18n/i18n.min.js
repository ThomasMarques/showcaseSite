/*
 * My own i18n with javascript
 * (Licensed under MIT)
 */
function createCookie(e, t, n) {
    var r;
    if (n) {
        var i = new Date;
        i.setTime(i.getTime() + n * 24 * 60 * 60 * 1e3);
        r = "; expires=" + i.toGMTString()
    } else {
        r = ""
    }
    document.cookie = e + "=" + t + r + "; path=/"
}

function getCookie(e) {
    if (document.cookie.length > 0) {
        c_start = document.cookie.indexOf(e + "=");
        if (c_start != -1) {
            c_start = c_start + e.length + 1;
            c_end = document.cookie.indexOf(";", c_start);
            if (c_end == -1) {
                c_end = document.cookie.length
            }
            return unescape(document.cookie.substring(c_start, c_end))
        }
    }
    return undefined
}


var value;
var json_data = new Object;

function changeLang(lang) {
    if (value == lang) 
        return;
    $(".to-fade").removeClass("fadein").addClass("fadeout");
    $(".i18n").removeClass("fadein").addClass("fadeout");
    value = lang;
    setTimeout(function () {
        if(value == "en") {
            $(".french-flag").addClass("off");
            $(".english-flag").removeClass("off");
        }
        else {
            $(".french-flag").removeClass("off");
            $(".english-flag").addClass("off");
        }
        $(".i18n").each(function() {
            $(this).html(
                json_data[value][this.getAttribute("i18n-key")]
            );
        });
        $(".to-fade").addClass("fadein").removeClass("fadeout");
        $(".i18n").addClass("fadein").removeClass("fadeout");
    }, 800);
}

$(document).ready(function () {
    {
        $.getJSON("resources/i18n/i18n-data.json", function(data) {
            data.forEach(function(entry) {
                json_data[entry.lang] = entry;
            });
        });
        value = getCookie("lang");
        if (value == undefined)
            value = "en";
        else if(value != "en")
            changeLang(value);
    }
    $(".i18n-language-selector").click(function (e) {
        changeLang(this.getAttribute("value"));
    })
})